     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_wait_int
     7 00000000                                 	EXTERN	_port_read
     8 00000000                                 	EXTERN	_sprintf
     9 00000000                                 	EXTERN	_api_putstr0
    10 00000000                                 	EXTERN	_api_end
    11 00000000                                 	EXTERN	_io_out8
    12 00000000                                 [FILE "hd2.c"]
    13                                          [SECTION .data]
    14 00000000                                 LC0:
    15 00000000 25 6C 78 00                     	DB	"%lx",0x00
    16                                          [SECTION .text]
    17 00000000                                 	GLOBAL	_HariMain
    18 00000000                                 _HariMain:
    19 00000000 55                              	PUSH	EBP
    20 00000001 89 E5                           	MOV	EBP,ESP
    21 00000003 53                              	PUSH	EBX
    22 00000004 83 EC 50                        	SUB	ESP,80
    23 00000007 8D 45 EC                        	LEA	EAX,DWORD [-20+EBP]
    24 0000000A 8D 5D AC                        	LEA	EBX,DWORD [-84+EBP]
    25 0000000D 50                              	PUSH	EAX
    26 0000000E C6 45 F1 A0                     	MOV	BYTE [-15+EBP],-96
    27 00000012 C6 45 F2 EC                     	MOV	BYTE [-14+EBP],-20
    28 00000016 E8 00000046                     	CALL	_hd_cmd_out
    29 0000001B E8 [00000000]                   	CALL	_wait_int
    30 00000020 68 00000200                     	PUSH	512
    31 00000025 68 [00000090]                   	PUSH	_hdbuf
    32 0000002A 68 00000170                     	PUSH	368
    33 0000002F E8 [00000000]                   	CALL	_port_read
    34 00000034 68 [00000090]                   	PUSH	_hdbuf
    35 00000039 68 [00000000]                   	PUSH	LC0
    36 0000003E 53                              	PUSH	EBX
    37 0000003F E8 [00000000]                   	CALL	_sprintf
    38 00000044 53                              	PUSH	EBX
    39 00000045 E8 [00000000]                   	CALL	_api_putstr0
    40 0000004A 83 C4 20                        	ADD	ESP,32
    41 0000004D 68 [00000090]                   	PUSH	_hdbuf
    42 00000052 E8 0000008D                     	CALL	_print_identify_info
    43 00000057 E8 [00000000]                   	CALL	_api_end
    44 0000005C 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
    45 0000005F C9                              	LEAVE
    46 00000060 C3                              	RET
    47 00000061                                 	GLOBAL	_hd_cmd_out
    48 00000061                                 _hd_cmd_out:
    49 00000061 55                              	PUSH	EBP
    50 00000062 89 E5                           	MOV	EBP,ESP
    51 00000064 53                              	PUSH	EBX
    52 00000065 6A 00                           	PUSH	0
    53 00000067 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
    54 0000006A 68 000003F6                     	PUSH	1014
    55 0000006F E8 [00000000]                   	CALL	_io_out8
    56 00000074 0F B6 03                        	MOVZX	EAX,BYTE [EBX]
    57 00000077 50                              	PUSH	EAX
    58 00000078 68 000001F1                     	PUSH	497
    59 0000007D E8 [00000000]                   	CALL	_io_out8
    60 00000082 0F B6 43 01                     	MOVZX	EAX,BYTE [1+EBX]
    61 00000086 50                              	PUSH	EAX
    62 00000087 68 000001F2                     	PUSH	498
    63 0000008C E8 [00000000]                   	CALL	_io_out8
    64 00000091 0F B6 43 02                     	MOVZX	EAX,BYTE [2+EBX]
    65 00000095 50                              	PUSH	EAX
    66 00000096 68 000001F3                     	PUSH	499
    67 0000009B E8 [00000000]                   	CALL	_io_out8
    68 000000A0 83 C4 20                        	ADD	ESP,32
    69 000000A3 0F B6 43 03                     	MOVZX	EAX,BYTE [3+EBX]
    70 000000A7 50                              	PUSH	EAX
    71 000000A8 68 000001F4                     	PUSH	500
    72 000000AD E8 [00000000]                   	CALL	_io_out8
    73 000000B2 0F B6 43 04                     	MOVZX	EAX,BYTE [4+EBX]
    74 000000B6 50                              	PUSH	EAX
    75 000000B7 68 000001F5                     	PUSH	501
    76 000000BC E8 [00000000]                   	CALL	_io_out8
    77 000000C1 0F B6 43 05                     	MOVZX	EAX,BYTE [5+EBX]
    78 000000C5 50                              	PUSH	EAX
    79 000000C6 68 000001F6                     	PUSH	502
    80 000000CB E8 [00000000]                   	CALL	_io_out8
    81 000000D0 0F B6 43 06                     	MOVZX	EAX,BYTE [6+EBX]
    82 000000D4 50                              	PUSH	EAX
    83 000000D5 68 000001F7                     	PUSH	503
    84 000000DA E8 [00000000]                   	CALL	_io_out8
    85 000000DF 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
    86 000000E2 C9                              	LEAVE
    87 000000E3 C3                              	RET
    88                                          [SECTION .data]
    89 00000004                                 LC1:
    90 00000004 48 44 20 53 4E 00               	DB	"HD SN",0x00
    91 0000000A                                 LC2:
    92 0000000A 48 44 20 4D 6F 64 65 6C 00      	DB	"HD Model",0x00
    93 00000013 00                              	ALIGNB	4
    94 00000014                                 LC3:
    95 00000014 0000000A                        	DD	10
    96 00000018 00000014                        	DD	20
    97 0000001C [00000004]                      	DD	LC1
    98 00000020 0000001B                        	DD	27
    99 00000024 00000028                        	DD	40
   100 00000028 [0000000A]                      	DD	LC2
   101 0000002C                                 LC4:
   102 0000002C 25 73 3A 20 25 73 0A 00         	DB	"%s: %s",0x0A,0x00
   103 00000034                                 LC5:
   104 00000034 59 65 73 00                     	DB	"Yes",0x00
   105 00000038                                 LC7:
   106 00000038 4C 42 41 20 73 75 70 70 6F 72   	DB	"LBA supported: %s",0x0A,0x00
       00000042 74 65 64 3A 20 25 73 0A 00 
   107 0000004B                                 LC8:
   108 0000004B 4C 42 41 34 38 20 73 75 70 70   	DB	"LBA48 supported: %s",0x0A,0x00
       00000055 6F 72 74 65 64 3A 20 25 73 0A 
       0000005F 00 
   109 00000060                                 LC9:
   110 00000060 48 44 20 73 69 7A 65 3A 20 25   	DB	"HD size: %dMB",0x0A,0x00
       0000006A 64 4D 42 0A 00 
   111 0000006F                                 LC6:
   112 0000006F 4E 6F 00                        	DB	"No",0x00
   113                                          [SECTION .text]
   114 000000E4                                 	GLOBAL	_print_identify_info
   115 000000E4                                 _print_identify_info:
   116 000000E4 55                              	PUSH	EBP
   117 000000E5 B9 00000006                     	MOV	ECX,6
   118 000000EA 89 E5                           	MOV	EBP,ESP
   119 000000EC 57                              	PUSH	EDI
   120 000000ED 56                              	PUSH	ESI
   121 000000EE BE [00000014]                   	MOV	ESI,LC3
   122 000000F3 53                              	PUSH	EBX
   123 000000F4 8D BD FFFFFF44                  	LEA	EDI,DWORD [-188+EBP]
   124 000000FA FC                              	CLD
   125 000000FB 81 EC 000000BC                  	SUB	ESP,188
   126 00000101 F3                              	REP
   127 00000102 A5                              	MOVSD
   128 00000103 C7 85 FFFFFF38 00000000         	MOV	DWORD [-200+EBP],0
   129 0000010D 8D 75 F4                        	LEA	ESI,DWORD [-12+EBP]
   130 00000110                                 L13:
   131 00000110 8B 86 FFFFFF50                  	MOV	EAX,DWORD [-176+ESI]
   132 00000116 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   133 00000119 BF 00000002                     	MOV	EDI,2
   134 0000011E 31 DB                           	XOR	EBX,EBX
   135 00000120 8D 0C 42                        	LEA	ECX,DWORD [EDX+EAX*2]
   136 00000123 89 B5 FFFFFF40                  	MOV	DWORD [-192+EBP],ESI
   137 00000129 8B 96 FFFFFF54                  	MOV	EDX,DWORD [-172+ESI]
   138 0000012F 89 D0                           	MOV	EAX,EDX
   139 00000131 99                              	CDQ
   140 00000132 F7 FF                           	IDIV	EDI
   141 00000134 89 85 FFFFFF3C                  	MOV	DWORD [-196+EBP],EAX
   142 0000013A 39 C3                           	CMP	EBX,EAX
   143 0000013C 7D 2F                           	JGE	L21
   144 0000013E                                 L12:
   145 0000013E 8A 01                           	MOV	AL,BYTE [ECX]
   146 00000140 BF 00000002                     	MOV	EDI,2
   147 00000145 41                              	INC	ECX
   148 00000146 88 44 5D B5                     	MOV	BYTE [-75+EBP+EBX*2],AL
   149 0000014A 8A 01                           	MOV	AL,BYTE [ECX]
   150 0000014C 41                              	INC	ECX
   151 0000014D 88 44 5D B4                     	MOV	BYTE [-76+EBP+EBX*2],AL
   152 00000151 43                              	INC	EBX
   153 00000152 8B 85 FFFFFF40                  	MOV	EAX,DWORD [-192+EBP]
   154 00000158 8B 90 FFFFFF54                  	MOV	EDX,DWORD [-172+EAX]
   155 0000015E 89 D0                           	MOV	EAX,EDX
   156 00000160 99                              	CDQ
   157 00000161 F7 FF                           	IDIV	EDI
   158 00000163 89 85 FFFFFF3C                  	MOV	DWORD [-196+EBP],EAX
   159 00000169 39 C3                           	CMP	EBX,EAX
   160 0000016B 7C D1                           	JL	L12
   161 0000016D                                 L21:
   162 0000016D 8D 45 B4                        	LEA	EAX,DWORD [-76+EBP]
   163 00000170 50                              	PUSH	EAX
   164 00000171 C6 44 5D B4 00                  	MOV	BYTE [-76+EBP+EBX*2],0
   165 00000176 FF B6 FFFFFF58                  	PUSH	DWORD [-168+ESI]
   166 0000017C 68 [0000002C]                   	PUSH	LC4
   167 00000181 8D 9D FFFFFF64                  	LEA	EBX,DWORD [-156+EBP]
   168 00000187 53                              	PUSH	EBX
   169 00000188 83 C6 0C                        	ADD	ESI,12
   170 0000018B E8 [00000000]                   	CALL	_sprintf
   171 00000190 53                              	PUSH	EBX
   172 00000191 E8 [00000000]                   	CALL	_api_putstr0
   173 00000196 FF 85 FFFFFF38                  	INC	DWORD [-200+EBP]
   174 0000019C 83 C4 14                        	ADD	ESP,20
   175 0000019F 83 BD FFFFFF38 01               	CMP	DWORD [-200+EBP],1
   176 000001A6 0F 86 FFFFFF64                  	JBE	L13
   177 000001AC 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   178 000001AF F6 40 63 02                     	TEST	BYTE [99+EAX],2
   179 000001B3 0F 84 00000087                  	JE	L14
   180 000001B9 B8 [00000034]                   	MOV	EAX,LC5
   181 000001BE                                 L15:
   182 000001BE 50                              	PUSH	EAX
   183 000001BF 8D 9D FFFFFF64                  	LEA	EBX,DWORD [-156+EBP]
   184 000001C5 68 [00000038]                   	PUSH	LC7
   185 000001CA 53                              	PUSH	EBX
   186 000001CB E8 [00000000]                   	CALL	_sprintf
   187 000001D0 53                              	PUSH	EBX
   188 000001D1 E8 [00000000]                   	CALL	_api_putstr0
   189 000001D6 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   190 000001D9 F6 82 000000A7 04               	TEST	BYTE [167+EDX],4
   191 000001E0 74 57                           	JE	L16
   192 000001E2 B8 [00000034]                   	MOV	EAX,LC5
   193 000001E7                                 L17:
   194 000001E7 50                              	PUSH	EAX
   195 000001E8 8D 9D FFFFFF64                  	LEA	EBX,DWORD [-156+EBP]
   196 000001EE 68 [0000004B]                   	PUSH	LC8
   197 000001F3 53                              	PUSH	EBX
   198 000001F4 E8 [00000000]                   	CALL	_sprintf
   199 000001F9 53                              	PUSH	EBX
   200 000001FA E8 [00000000]                   	CALL	_api_putstr0
   201 000001FF 83 C4 20                        	ADD	ESP,32
   202 00000202 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   203 00000205 0F B7 41 7A                     	MOVZX	EAX,WORD [122+ECX]
   204 00000209 0F B7 51 78                     	MOVZX	EDX,WORD [120+ECX]
   205 0000020D C1 E0 10                        	SAL	EAX,16
   206 00000210 01 D0                           	ADD	EAX,EDX
   207 00000212 BA 000F4240                     	MOV	EDX,1000000
   208 00000217 C1 E0 09                        	SAL	EAX,9
   209 0000021A 89 D7                           	MOV	EDI,EDX
   210 0000021C 99                              	CDQ
   211 0000021D F7 FF                           	IDIV	EDI
   212 0000021F 50                              	PUSH	EAX
   213 00000220 68 [00000060]                   	PUSH	LC9
   214 00000225 53                              	PUSH	EBX
   215 00000226 E8 [00000000]                   	CALL	_sprintf
   216 0000022B 53                              	PUSH	EBX
   217 0000022C E8 [00000000]                   	CALL	_api_putstr0
   218 00000231 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   219 00000234 5B                              	POP	EBX
   220 00000235 5E                              	POP	ESI
   221 00000236 5F                              	POP	EDI
   222 00000237 5D                              	POP	EBP
   223 00000238 C3                              	RET
   224 00000239                                 L16:
   225 00000239 B8 [0000006F]                   	MOV	EAX,LC6
   226 0000023E EB A7                           	JMP	L17
   227 00000240                                 L14:
   228 00000240 B8 [0000006F]                   	MOV	EAX,LC6
   229 00000245 E9 FFFFFF74                     	JMP	L15
   230 0000024A                                 	GLOBAL	_PARTITION_ENTRY
   231                                          [SECTION .data]
   232 00000072 00 00 00 00 00 00 00 00 00 00   	ALIGNB	16
       0000007C 00 00 00 00 
   233 00000080                                 _PARTITION_ENTRY:
   234 00000080 00 00 00 00 00 00 00 00 00 00   	RESB	16
       0000008A 00 00 00 00 00 00 
   235 00000090                                 	GLOBAL	_hdbuf
   236                                          [SECTION .data]
   237 00000090                                 	ALIGNB	16
   238 00000090                                 _hdbuf:
   239 00000090 00 00 00 00 00 00 00 00 00 00   	RESB	1024
       0000009A 00 00 00 00 00 00 00 00 00 00 
       000000A4 00 00 00 00 00 00 00 00 00 00 
       000000AE 00 00 00 00 00 00 00 00 00 00 
       000000B8 00 00 00 00 00 00 00 00 00 00 
       000000C2 00 00 00 00 00 00 00 00 00 00 
       000000CC 00 00 00 00 00 00 00 00 00 00 
       000000D6 00 00 00 00 00 00 00 00 00 00 
       000000E0 00 00 00 00 00 00 00 00 00 00 
       000000EA 00 00 00 00 00 00 00 00 00 00 
       000000F4 00 00 00 00 00 00 00 00 00 00 
       000000FE 00 00 00 00 00 00 00 00 00 00 
       00000108 00 00 00 00 00 00 00 00 00 00 
       00000112 00 00 00 00 00 00 00 00 00 00 
       0000011C 00 00 00 00 00 00 00 00 00 00 
       00000126 00 00 00 00 00 00 00 00 00 00 
       00000130 00 00 00 00 00 00 00 00 00 00 
       0000013A 00 00 00 00 00 00 00 00 00 00 
       00000144 00 00 00 00 00 00 00 00 00 00 
       0000014E 00 00 00 00 00 00 00 00 00 00 
       00000158 00 00 00 00 00 00 00 00 00 00 
       00000162 00 00 00 00 00 00 00 00 00 00 
       0000016C 00 00 00 00 00 00 00 00 00 00 
       00000176 00 00 00 00 00 00 00 00 00 00 
       00000180 00 00 00 00 00 00 00 00 00 00 
       0000018A 00 00 00 00 00 00 00 00 00 00 
       00000194 00 00 00 00 00 00 00 00 00 00 
       0000019E 00 00 00 00 00 00 00 00 00 00 
       000001A8 00 00 00 00 00 00 00 00 00 00 
       000001B2 00 00 00 00 00 00 00 00 00 00 
       000001BC 00 00 00 00 00 00 00 00 00 00 
       000001C6 00 00 00 00 00 00 00 00 00 00 
       000001D0 00 00 00 00 00 00 00 00 00 00 
       000001DA 00 00 00 00 00 00 00 00 00 00 
       000001E4 00 00 00 00 00 00 00 00 00 00 
       000001EE 00 00 00 00 00 00 00 00 00 00 
       000001F8 00 00 00 00 00 00 00 00 00 00 
       00000202 00 00 00 00 00 00 00 00 00 00 
       0000020C 00 00 00 00 00 00 00 00 00 00 
       00000216 00 00 00 00 00 00 00 00 00 00 
       00000220 00 00 00 00 00 00 00 00 00 00 
       0000022A 00 00 00 00 00 00 00 00 00 00 
       00000234 00 00 00 00 00 00 00 00 00 00 
       0000023E 00 00 00 00 00 00 00 00 00 00 
       00000248 00 00 00 00 00 00 00 00 00 00 
       00000252 00 00 00 00 00 00 00 00 00 00 
       0000025C 00 00 00 00 00 00 00 00 00 00 
       00000266 00 00 00 00 00 00 00 00 00 00 
       00000270 00 00 00 00 00 00 00 00 00 00 
       0000027A 00 00 00 00 00 00 00 00 00 00 
       00000284 00 00 00 00 00 00 00 00 00 00 
       0000028E 00 00 00 00 00 00 00 00 00 00 
       00000298 00 00 00 00 00 00 00 00 00 00 
       000002A2 00 00 00 00 00 00 00 00 00 00 
       000002AC 00 00 00 00 00 00 00 00 00 00 
       000002B6 00 00 00 00 00 00 00 00 00 00 
       000002C0 00 00 00 00 00 00 00 00 00 00 
       000002CA 00 00 00 00 00 00 00 00 00 00 
       000002D4 00 00 00 00 00 00 00 00 00 00 
       000002DE 00 00 00 00 00 00 00 00 00 00 
       000002E8 00 00 00 00 00 00 00 00 00 00 
       000002F2 00 00 00 00 00 00 00 00 00 00 
       000002FC 00 00 00 00 00 00 00 00 00 00 
       00000306 00 00 00 00 00 00 00 00 00 00 
       00000310 00 00 00 00 00 00 00 00 00 00 
       0000031A 00 00 00 00 00 00 00 00 00 00 
       00000324 00 00 00 00 00 00 00 00 00 00 
       0000032E 00 00 00 00 00 00 00 00 00 00 
       00000338 00 00 00 00 00 00 00 00 00 00 
       00000342 00 00 00 00 00 00 00 00 00 00 
       0000034C 00 00 00 00 00 00 00 00 00 00 
       00000356 00 00 00 00 00 00 00 00 00 00 
       00000360 00 00 00 00 00 00 00 00 00 00 
       0000036A 00 00 00 00 00 00 00 00 00 00 
       00000374 00 00 00 00 00 00 00 00 00 00 
       0000037E 00 00 00 00 00 00 00 00 00 00 
       00000388 00 00 00 00 00 00 00 00 00 00 
       00000392 00 00 00 00 00 00 00 00 00 00 
       0000039C 00 00 00 00 00 00 00 00 00 00 
       000003A6 00 00 00 00 00 00 00 00 00 00 
       000003B0 00 00 00 00 00 00 00 00 00 00 
       000003BA 00 00 00 00 00 00 00 00 00 00 
       000003C4 00 00 00 00 00 00 00 00 00 00 
       000003CE 00 00 00 00 00 00 00 00 00 00 
       000003D8 00 00 00 00 00 00 00 00 00 00 
       000003E2 00 00 00 00 00 00 00 00 00 00 
       000003EC 00 00 00 00 00 00 00 00 00 00 
       000003F6 00 00 00 00 00 00 00 00 00 00 
       00000400 00 00 00 00 00 00 00 00 00 00 
       0000040A 00 00 00 00 00 00 00 00 00 00 
       00000414 00 00 00 00 00 00 00 00 00 00 
       0000041E 00 00 00 00 00 00 00 00 00 00 
       00000428 00 00 00 00 00 00 00 00 00 00 
       00000432 00 00 00 00 00 00 00 00 00 00 
       0000043C 00 00 00 00 00 00 00 00 00 00 
       00000446 00 00 00 00 00 00 00 00 00 00 
       00000450 00 00 00 00 00 00 00 00 00 00 
       0000045A 00 00 00 00 00 00 00 00 00 00 
       00000464 00 00 00 00 00 00 00 00 00 00 
       0000046E 00 00 00 00 00 00 00 00 00 00 
       00000478 00 00 00 00 00 00 00 00 00 00 
       00000482 00 00 00 00 00 00 00 00 00 00 
       0000048C 00 00 00 00 
