这里的大部分是c++代码
